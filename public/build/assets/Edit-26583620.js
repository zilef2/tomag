import{k as M,T as L,C as P,x as z,l as S,f as n,a as r,w as V,o as c,b as s,t as v,u as a,g as u,d as $,n as J,e as X}from"./app-64491542.js";import{_ as p}from"./InputError-fa3e1639.js";import{_ as F,a as D}from"./TextInput-8835f8f7.js";import{_ as G,a as H}from"./SecondaryButton-4a877555.js";import{_ as K}from"./PrimaryButton-4c3adb2e.js";import{C as _}from"./vue-select-d9b12732.js";import"./vue-datepicker-265c879c.js";import{L as f}from"./global-8f0e871b.js";const Q={class:"space-y-6"},W=["onSubmit"],Y={class:"text-lg font-medium text-gray-900 dark:text-gray-100"},Z={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-6"},ee={key:0,id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},ae=s("label",{name:""}," Reportar en nombre de: ",-1),oe={id:"opcinesActividadO",class:"xl:col-span-2 col-span-1"},ie=s("label",{name:""}," Tipo de reporte ",-1),te={class:"xl:col-span-1 col-span-1"},de={class:"col-span-1"},le={key:1,id:"Sordentrabajo",class:"lg:col-span-2 col-span-1"},re=s("label",{name:"Select_ordentrabajo"}," Orden de trabajo ",-1),se={id:"Scentrotrabajo",class:"col-span-1"},ne=s("label",{name:"centrotrabajo_id"}," Centro de trabajo ",-1),ce={key:2,id:"Sactividad",class:"xl:col-span-2 col-span-1"},pe=s("label",{name:"label_actividad_id"}," Actividad ",-1),_e={key:3,id:"Sreproceso",class:"xl:col-span-2 col-span-1"},ue=s("label",{name:"reproceso_id"}," Reproceso",-1),be={key:4,id:"Sdisponibilidad",class:"xl:col-span-3 col-span-1"},me=s("label",{name:"disponibilidad_id"}," Disponibilidad",-1),ge={class:"mb-8 mt-[360px] flex justify-end"},ve={key:0,class:"mx-12 px-8 text-lg font-medium text-red-600 bg-red-50 dark:text-gray-100"},we={__name:"Edit",props:{show:Boolean,title:String,generica:Object,losSelect:Object,numberPermissions:Number,Trabajadores:Object},emits:["close"],setup(y,{emit:j}){const o=y,x=[{title:"Actividad",value:0},{title:"Reproceso",value:1},{title:"Disponibilidad(paro)",value:2}],l=M({params:{pregunta:""},actividad_id:o.losSelect.actividad,centrotrabajo_id:o.losSelect.centrotrabajo,disponibilidad_id:o.losSelect.disponibilidad,ordentrabajoSelect:o.losSelect.ordentrabajo,reproceso_id:o.losSelect.reproceso,valorInactivo:"NA",Select_ordentrabajo:[],mensajeFalta:"",BanderaTipo:!0}),e=L({...Object.fromEntries(["tipoReporte","fecha","hora_inicial","hora_final","actividad_id","centrotrabajo_id","disponibilidad_id","operario_id","ordentrabajo_id","reproceso_id","Select_ordentrabajo","otitem","user_id"].map(i=>[i,""]))});P(()=>{}),z(()=>{o.show?e.errors={}:l.BanderaTipo=!0});let h=i=>{let t="";try{i.forEach((d,b)=>{if(typeof e[d]>"u"||e[d]===null||e[d].length===0)throw t=d,new Error("BreakException")})}catch{}return t},I=()=>{let i=e.tipoReporte.value,t=!0;const d=" es obligatorio";i===0&&(t=h(["Select_ordentrabajo","centrotrabajo_id","actividad_id"])),i===1&&(t=h(["centrotrabajo_id","Select_ordentrabajo","actividad_id","reproceso_id"])),i===2&&(t=h(["centrotrabajo_id","disponibilidad_id"]));let b={Select_ordentrabajo:"Orden trabajo",actividad_id:"Actividad",reproceso_id:"Reproceso",centrotrabajo_id:"Centro de trabajo",disponibilidad_id:"Disponibilidad"};return t!=""?b[t]+d:t};const R=()=>{var t;e.ordentrabajo_id=e.Select_ordentrabajo,l.mensajeFalta=I();let i;i=f(o.losSelect.centrotrabajo,e.centrotrabajo_id),e.centrotrabajo_id=i!==""?i:"",e.tipoReporte.value===0&&(i=f(o.losSelect.actividad,e.actividad_id),e.actividad_id=i!==""?i:""),e.tipoReporte.value===1&&(i=f(o.losSelect.actividad,e.actividad_id),e.actividad_id=i!==""?i:"",i=f(o.losSelect.reproceso,e.reproceso_id),e.reproceso_id=i!==""?i:""),e.tipoReporte.value===2&&(i=f(o.losSelect.disponibilidad,e.disponibilidad_id),e.disponibilidad_id=i!==""?i:""),l.mensajeFalta===""&&e.put(route("reporte.update",(t=o.generica)==null?void 0:t.id),{preserveScroll:!0,onSuccess:()=>{j("close"),e.reset()},onError:()=>alert(JSON.stringify(e.errors,null,4)),onFinish:()=>null})};return S(()=>e.Select_ordentrabajo,i=>{}),S(()=>o.show,()=>{var i,t,d,b,k,w,T,O,B,N,C,U;if(l.BanderaTipo){l.BanderaTipo=!1,e.tipoReporte=x[(i=o.generica)==null?void 0:i.tipoReporte];let A=o.losSelect.ordentrabajo.findIndex(m=>{var g,E;if(m.value===parseInt((g=o.generica)==null?void 0:g.ordentrabajo_id))return console.log(m.value,(E=o.generica)==null?void 0:E.ordentrabajo_id),m});e.Select_ordentrabajo=l.ordentrabajoSelect[A],e.centrotrabajo_id=l.centrotrabajo_id[(t=o.generica)==null?void 0:t.centrotrabajo_id],console.log(o.losSelect.ordentrabajo),console.log((d=o.generica)==null?void 0:d.ordentrabajo_id),console.log(A),e.actividad_id=l.actividad_id[(b=o.generica)==null?void 0:b.actividad_id]?l.actividad_id[(k=o.generica)==null?void 0:k.actividad_id]:null,e.disponibilidad_id=l.disponibilidad_id[(w=o.generica)==null?void 0:w.disponibilidad_id]?l.disponibilidad_id[(T=o.generica)==null?void 0:T.disponibilidad_id]:null,e.reproceso_id=l.reproceso_id[(O=o.generica)==null?void 0:O.reproceso_id]?l.reproceso_id[(B=o.generica)==null?void 0:B.reproceso_id]:null,e.cantidad=(N=o.generica)==null?void 0:N.cantidad,e.fecha=(C=o.generica)==null?void 0:C.fecha,e.hora_inicial=(U=o.generica)==null?void 0:U.hora_inicial;let q=o.Trabajadores.findIndex(m=>{var g;return m.value===((g=o.generica)==null?void 0:g.operario_id)});e.user_id=o.Trabajadores[q]}else l.BanderaTipo=!o.show}),S(()=>e.centrotrabajo_id,(i,t)=>{if(i&&typeof i.value<"u"){let d="centrotrabajo"+i.title;l.actividad_id=o.losSelect[d],i.value!==o.generica.centrotrabajo_id&&(e.actividad_id={title:"Seleccione actividad",value:null})}}),(i,t)=>(c(),n("section",Q,[r(G,{show:o.show,onClose:t[10]||(t[10]=d=>(j("close"),l.BanderaTipo=!0))},{default:V(()=>[s("form",{class:"px-6 my-8",onSubmit:X(R,["prevent"])},[s("h2",Y,v(i.lang().label.edit)+" "+v(o.title),1),s("div",Z,[o.numberPermissions>9?(c(),n("div",ee,[ae,r(a(_),{options:o.Trabajadores,disabled:"",label:"title",modelValue:a(e).user_id,"onUpdate:modelValue":t[0]||(t[0]=d=>a(e).user_id=d)},null,8,["options","modelValue"])])):u("",!0),s("div",oe,[ie,r(a(_),{options:x,label:"title",disabled:"",modelValue:a(e).tipoReporte,"onUpdate:modelValue":t[1]||(t[1]=d=>a(e).tipoReporte=d)},null,8,["modelValue"])]),s("div",te,[r(F,{for:"fecha",value:i.lang().label.fecha},null,8,["value"]),r(D,{id:"fecha",type:"date",class:"mt-1 block w-full bg-gray-200",modelValue:a(e).fecha,"onUpdate:modelValue":t[2]||(t[2]=d=>a(e).fecha=d),disabled:"",placeholder:"fecha",error:a(e).errors.fecha},null,8,["modelValue","error"]),r(p,{class:"mt-2",message:a(e).errors.fecha},null,8,["message"])]),s("div",de,[r(F,{for:"hora_inicial",value:i.lang().label["hora inicial"]},null,8,["value"]),r(D,{id:"hora_inicial",type:"time",class:"mt-1 block w-full bg-gray-200",modelValue:a(e).hora_inicial,"onUpdate:modelValue":t[3]||(t[3]=d=>a(e).hora_inicial=d),placeholder:"hora_inicial",error:a(e).errors.hora_inicial,step:"60"},null,8,["modelValue","error"]),r(p,{class:"mt-2",message:a(e).errors.hora_inicial},null,8,["message"])]),a(e).tipoReporte.value!==2?(c(),n("div",le,[re,r(a(_),{options:y.losSelect.ordentrabajo,label:"title",class:"dark:bg-gray-400",modelValue:a(e).Select_ordentrabajo,"onUpdate:modelValue":t[4]||(t[4]=d=>a(e).Select_ordentrabajo=d)},null,8,["options","modelValue"]),r(p,{class:"mt-2",message:a(e).errors.ordentrabajo_id},null,8,["message"])])):u("",!0),s("div",se,[ne,r(a(_),{options:l.centrotrabajo_id,label:"title",modelValue:a(e).centrotrabajo_id,"onUpdate:modelValue":t[5]||(t[5]=d=>a(e).centrotrabajo_id=d)},null,8,["options","modelValue"]),r(p,{class:"mt-2",message:a(e).errors.centrotrabajo_id},null,8,["message"])]),a(e).tipoReporte.value===0||a(e).tipoReporte.value===1?(c(),n("div",ce,[pe,r(a(_),{options:l.actividad_id,label:"title",required:"",modelValue:a(e).actividad_id,"onUpdate:modelValue":t[6]||(t[6]=d=>a(e).actividad_id=d)},null,8,["options","modelValue"]),r(p,{class:"mt-2",message:a(e).errors.actividad_id},null,8,["message"])])):u("",!0),a(e).tipoReporte.value===1?(c(),n("div",_e,[ue,r(a(_),{options:l.reproceso_id,label:"title",required:"",modelValue:a(e).reproceso_id,"onUpdate:modelValue":t[7]||(t[7]=d=>a(e).reproceso_id=d)},null,8,["options","modelValue"]),r(p,{class:"mt-2",message:a(e).errors.reproceso_id},null,8,["message"])])):u("",!0),a(e).tipoReporte.value===2?(c(),n("div",be,[me,r(a(_),{options:l.disponibilidad_id,label:"title",required:"",modelValue:a(e).disponibilidad_id,"onUpdate:modelValue":t[8]||(t[8]=d=>a(e).disponibilidad_id=d)},null,8,["options","modelValue"]),r(p,{class:"mt-2",message:a(e).errors.disponibilidad_id},null,8,["message"])])):u("",!0)]),s("div",ge,[l.mensajeFalta!=""?(c(),n("h2",ve,v(l.mensajeFalta),1)):u("",!0),r(H,{disabled:a(e).processing,onClick:t[9]||(t[9]=d=>j("close"))},{default:V(()=>[$(v(i.lang().button.close),1)]),_:1},8,["disabled"]),r(K,{class:J(["ml-3",{"opacity-25":a(e).processing}]),disabled:a(e).processing,onClick:R},{default:V(()=>[$(v(a(e).processing?i.lang().button.save+"...":i.lang().button.save),1)]),_:1},8,["class","disabled"])])],40,W)]),_:1},8,["show"])]))}};export{we as default};
